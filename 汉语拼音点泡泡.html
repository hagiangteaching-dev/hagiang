<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±‰è¯­æ‹¼éŸ³ç‚¹æ³¡æ³¡</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Comic Sans MS", "æ¥·ä½“", "å¾®è½¯é›…é»‘", sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #ffd6e7 0%, #c2f0fc 100%);
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            box-shadow: 0 15px 35px rgba(255, 150, 200, 0.3);
            padding: 25px;
            position: relative;
            border: 5px solid #ffb6c1;
            overflow: hidden;
        }
        
        .container::before {
            content: "";
            position: absolute;
            top: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23FFD1DC" stroke="%23FFB6C1" stroke-width="3"/></svg>');
            background-size: contain;
            z-index: 0;
        }
        
        .container::after {
            content: "";
            position: absolute;
            bottom: -30px;
            left: -30px;
            width: 120px;
            height: 120px;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%23C2F0FC" stroke="%2391D1E5" stroke-width="3"/></svg>');
            background-size: contain;
            z-index: 0;
        }
        
        header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 3px dotted #ff9ac8;
            position: relative;
            z-index: 1;
        }
        
        h1 {
            font-size: 3.5rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            color: #ff6b9d;
            background: linear-gradient(45deg, #ff6b9d, #ff9ac8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            display: inline-block;
        }
        
        h1::after {
            content: "âœ¨";
            position: absolute;
            top: -10px;
            right: -30px;
            font-size: 2rem;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            background: linear-gradient(45deg, #ffd1dc, #c2f0fc);
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            box-shadow: 0 5px 15px rgba(255, 150, 200, 0.2);
            position: relative;
            z-index: 1;
            border: 3px solid #ffb6c1;
        }
        
        .info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 5px 15px;
        }
        
        .info-label {
            font-size: 1rem;
            color: #ff6b9d;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .info-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #5a8ee0;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            background: white;
            padding: 5px 15px;
            border-radius: 50px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 25px;
            justify-content: center;
            align-items: center;
            position: relative;
            z-index: 1;
        }
        
        button {
            background: linear-gradient(45deg, #ff9ac8, #ff6b9d);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.4);
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 107, 157, 0.6);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background: linear-gradient(45deg, #e0e0e0, #b0b0b0);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .voice-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            background: linear-gradient(45deg, #d4fc79, #96e6a1);
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 25px;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
            border: 3px solid #a8e6a8;
        }
        
        select, input[type="range"] {
            padding: 10px;
            border-radius: 10px;
            border: 2px solid #ffb6c1;
            background: white;
            font-size: 1rem;
        }
        
        .bubble-container {
            position: relative;
            width: 100%;
            height: 550px;
            border: 3px dashed #ff9ac8;
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 25px;
            background: linear-gradient(45deg, #e0f7fa, #bbdefb);
            box-shadow: inset 0 0 20px rgba(255, 150, 200, 0.2);
            position: relative;
            z-index: 1;
        }
        
        .bubble {
            position: absolute;
            width: 130px;
            height: 130px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 1.5rem;
            font-weight: bold;
            color: #5a5a5a;
            text-align: center;
            transition: transform 0.2s;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            z-index: 10;
            /* é€æ˜æ³¡æ³¡æ•ˆæœ */
            background: rgba(255, 255, 255, 0.8);
            border: 3px solid rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
        }
        
        .bubble::before {
            content: "";
            position: absolute;
            top: 10px;
            left: 20px;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 50%;
        }
        
        .bubble.hidden {
            opacity: 0.3;
            filter: blur(3px);
        }
        
        .bubble.correct {
            background: rgba(166, 226, 166, 0.8);
            border: 3px solid rgba(120, 200, 120, 0.9);
            animation: correct 0.5s ease-in-out;
        }
        
        .bubble.incorrect {
            background: rgba(255, 173, 173, 0.8);
            border: 3px solid rgba(255, 120, 120, 0.9);
            animation: incorrect 0.5s ease-in-out;
        }
        
        .bubble.normal {
            background: rgba(255, 255, 255, 0.8);
            border: 3px solid rgba(255, 255, 255, 0.9);
        }
        
        @keyframes correct {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }
        
        @keyframes incorrect {
            0% { transform: translateX(0); }
            25% { transform: translateX(-15px); }
            50% { transform: translateX(15px); }
            75% { transform: translateX(-15px); }
            100% { transform: translateX(0); }
        }
        
        @keyframes float {
            0% {
                transform: translate(0, 0);
            }
            25% {
                transform: translate(var(--x-movement), var(--y-movement-quarter));
            }
            50% {
                transform: translate(calc(var(--x-movement) * 1.5), var(--y-movement-half));
            }
            75% {
                transform: translate(var(--x-movement), var(--y-movement-three-quarters));
            }
            100% {
                transform: translate(0, var(--y-movement));
            }
        }
        
        .progress-bar {
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 25px;
            overflow: hidden;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
            border: 2px solid #ffb6c1;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(45deg, #a8e6a8, #6bc46b);
            width: 100%;
            transition: width 0.1s linear;
            border-radius: 10px;
        }
        
        .instructions {
            background: linear-gradient(45deg, #ffd1dc, #c2f0fc);
            padding: 20px;
            border-radius: 20px;
            margin-bottom: 25px;
            line-height: 1.6;
            box-shadow: 0 5px 15px rgba(255, 150, 200, 0.2);
            position: relative;
            z-index: 1;
            border: 3px solid #ffb6c1;
        }
        
        .instructions h3 {
            color: #ff6b9d;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.5rem;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 35px;
            border-radius: 25px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border: 5px solid #ffb6c1;
            position: relative;
        }
        
        .modal-content::before {
            content: "ğŸ‰";
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 3rem;
            background: white;
            padding: 10px;
            border-radius: 50%;
            border: 3px solid #ffb6c1;
        }
        
        .modal h2 {
            color: #ff6b9d;
            margin-bottom: 25px;
            text-align: center;
            font-size: 2.5rem;
        }
        
        .result-item {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            border-radius: 10px;
        }
        
        .result-item.correct {
            background: #e8f5e9;
        }
        
        .result-item.incorrect {
            background: #ffebee;
        }
        
        .correct-answer {
            color: #4caf50;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .welcome-page {
            text-align: center;
            padding: 30px;
            position: relative;
            z-index: 1;
        }
        
        .welcome-page h2 {
            color: #ff6b9d;
            margin-bottom: 20px;
            font-size: 2.5rem;
        }
        
        .welcome-page p {
            margin-bottom: 15px;
            font-size: 1.1rem;
            line-height: 1.6;
        }
        
        .demo-section {
            background: linear-gradient(45deg, #ffd1dc, #c2f0fc);
            padding: 20px;
            border-radius: 20px;
            margin: 25px 0;
            box-shadow: 0 5px 15px rgba(255, 150, 200, 0.2);
            border: 3px solid #ffb6c1;
        }
        
        .demo-section h3 {
            color: #ff6b9d;
            margin-bottom: 15px;
        }
        
        .demo-words {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }
        
        .demo-word {
            background: white;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
            border: 2px solid #ffb6c1;
        }
        
        .demo-word:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            background: #fff0f5;
        }
        
        .pause-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 20;
            color: white;
            font-size: 2rem;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .game-info {
                flex-direction: column;
                align-items: center;
            }
            
            .info-item {
                margin: 10px 0;
            }
            
            .bubble-container {
                height: 450px;
            }
            
            .bubble {
                width: 110px;
                height: 110px;
                font-size: 1.3rem;
            }
            
            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- æ¬¢è¿é¡µé¢ -->
    <div class="container" id="welcome-page">
        <header>
            <h1>æ±‰è¯­æ‹¼éŸ³ç‚¹æ³¡æ³¡</h1>
            <p>æ¬¢è¿æ¥åˆ°å¯çˆ±çš„æ‹¼éŸ³å­¦ä¹ æ¸¸æˆï¼ğŸˆ</p>
        </header>
        
        <div class="welcome-page">
            <h2>æ¬¢è¿æŒ‘æˆ˜æ‹¼éŸ³æ³¡æ³¡æ¸¸æˆï¼</h2>
            <p>è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„æ±‰è¯­æ‹¼éŸ³å­¦ä¹ æ¸¸æˆï¼Œé€šè¿‡å¬éŸ³è¾¨è¯æ¥æé«˜æ‚¨çš„æ‹¼éŸ³è¯†åˆ«èƒ½åŠ›ã€‚</p>
            
            <div class="instructions">
                <h3>æ¸¸æˆè§„åˆ™</h3>
                <p>1. ç³»ç»Ÿä¼šæ’­æ”¾ä¸¤æ¬¡è¯è¯­çš„å‘éŸ³</p>
                <p>2. åœ¨10ç§’å†…ç‚¹å‡»æ­£ç¡®çš„æ‹¼éŸ³æ³¡æ³¡</p>
                <p>3. å•éŸ³èŠ‚è¯è¯­çš„æ³¡æ³¡éƒ½æ˜¯å•éŸ³èŠ‚æ‹¼éŸ³ï¼ŒåŒéŸ³èŠ‚è¯è¯­çš„æ³¡æ³¡éƒ½æ˜¯åŒéŸ³èŠ‚æ‹¼éŸ³</p>
                <p>4. æ¸¸æˆå…±10è½®ï¼Œæ¯ç­”å¯¹ä¸€é¢˜å¾—10åˆ†</p>
                <p>5. å¯ä»¥éšæ—¶æš‚åœæ¸¸æˆ</p>
                <p>6. æ¸¸æˆç»“æŸåå¯ä»¥æŸ¥çœ‹æˆç»©å’Œæ­£ç¡®ç­”æ¡ˆ</p>
            </div>
            
            <div class="demo-section">
                <h3>è¯­éŸ³è¯•å¬</h3>
                <p>è¯·é€‰æ‹©æ‚¨å–œæ¬¢çš„è¯­éŸ³å¹¶è°ƒæ•´è¯­é€Ÿï¼Œç„¶åç‚¹å‡»ä¸‹æ–¹è¯è¯­è¯•å¬ï¼š</p>
                
                <div class="voice-controls">
                    <label for="welcome-voice-select">é€‰æ‹©è¯­éŸ³ï¼š</label>
                    <select id="welcome-voice-select">
                        <option value="">æ­£åœ¨åŠ è½½è¯­éŸ³...</option>
                    </select>
                    
                    <label for="welcome-rate-control">è¯­é€Ÿï¼š</label>
                    <input type="range" id="welcome-rate-control" min="0.5" max="2" step="0.1" value="1">
                    <span id="welcome-rate-value">1.0</span>
                    
                    <label for="welcome-volume-control">éŸ³é‡ï¼š</label>
                    <input type="range" id="welcome-volume-control" min="0" max="1" step="0.1" value="1">
                    <span id="welcome-volume-value">1.0</span>
                </div>
                
                <div class="demo-words">
                    <div class="demo-word" data-word="ä½ å¥½">ä½ å¥½</div>
                    <div class="demo-word" data-word="è°¢è°¢">è°¢è°¢</div>
                    <div class="demo-word" data-word="è€å¸ˆ">è€å¸ˆ</div>
                    <div class="demo-word" data-word="å­¦ç”Ÿ">å­¦ç”Ÿ</div>
                    <div class="demo-word" data-word="ä¸­å›½">ä¸­å›½</div>
                </div>
            </div>
            
            <button id="start-game-btn">å¼€å§‹æ¸¸æˆ ğŸ®</button>
        </div>
    </div>
    
    <!-- æ¸¸æˆé¡µé¢ -->
    <div class="container" id="game-page" style="display: none;">
        <header>
            <h1>æ±‰è¯­æ‹¼éŸ³ç‚¹æ³¡æ³¡</h1>
            <p>å¬è¯è¯­å‘éŸ³ï¼Œç‚¹å‡»æ­£ç¡®çš„æ‹¼éŸ³æ³¡æ³¡ï¼æ¯è½®10ç§’ï¼Œå…±10è½®ï¼Œæ¯é¢˜10åˆ†ã€‚</p>
        </header>
        
        <div class="game-info">
            <div class="info-item">
                <span class="info-label">å½“å‰è½®æ•°</span>
                <span class="info-value" id="round-display">0/10</span>
            </div>
            <div class="info-item">
                <span class="info-label">å½“å‰å¾—åˆ†</span>
                <span class="info-value" id="score-display">0</span>
            </div>
            <div class="info-item">
                <span class="info-label">å‰©ä½™æ—¶é—´</span>
                <span class="info-value" id="timer-display">10ç§’</span>
            </div>
        </div>
        
        <div class="progress-bar">
            <div class="progress" id="time-progress"></div>
        </div>
        
        <div class="controls">
            <button id="pause-btn">æš‚åœæ¸¸æˆ â¸ï¸</button>
            <button id="play-btn">æ’­æ”¾å‘éŸ³ ğŸ”Š</button>
            <button id="restart-game-btn">é‡æ–°å¼€å§‹ ğŸ”„</button>
        </div>
        
        <div class="bubble-container" id="bubble-container">
            <!-- æ³¡æ³¡å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>
    
    <!-- æ¸¸æˆç»“æŸæ¨¡æ€æ¡† -->
    <div class="modal" id="game-over-modal">
        <div class="modal-content">
            <h2>æ¸¸æˆç»“æŸ</h2>
            <p>ä½ çš„å¾—åˆ†ï¼š<span id="final-score">0</span> / 100</p>
            <div id="results-list">
                <!-- ç»“æœå°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <div class="controls" style="margin-top: 20px;">
                <button id="restart-btn">å†æ¥ä¸€å±€ ğŸ¯</button>
                <button id="back-to-welcome">è¿”å›é¦–é¡µ ğŸ </button>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆå‚æ•°é…ç½®
        const TOTAL_ROUNDS = 10;
        const TIME_PER_ROUND = 10;
        const POINTS_PER_CORRECT = 10;
        const MIN_BUBBLE_COUNT = 3;
        const MAX_BUBBLE_COUNT = 4;
        const BUBBLE_MIN_DURATION = 3;
        const BUBBLE_MAX_DURATION = 6;

        // HSK1çº§è¯æ±‡åº“
        const wordLibrary = [
            {chinese: "æˆ‘", pinyin: "wÇ’", audio: ""},
            {chinese: "ä½ ", pinyin: "nÇ", audio: ""},
            {chinese: "ä»–", pinyin: "tÄ", audio: ""},
            {chinese: "å¥¹", pinyin: "tÄ", audio: ""},
            {chinese: "æˆ‘ä»¬", pinyin: "wÇ’ men", audio: ""},
            {chinese: "ä½ ä»¬", pinyin: "nÇ men", audio: ""},
            {chinese: "ä»–ä»¬", pinyin: "tÄ men", audio: ""},
            {chinese: "å¦ˆå¦ˆ", pinyin: "mÄ ma", audio: ""},
            {chinese: "çˆ¸çˆ¸", pinyin: "bÃ  ba", audio: ""},
            {chinese: "è€å¸ˆ", pinyin: "lÇo shÄ«", audio: ""},
            {chinese: "å­¦ç”Ÿ", pinyin: "xuÃ© sheng", audio: ""},
            {chinese: "ä¸€", pinyin: "yÄ«", audio: ""},
            {chinese: "äºŒ", pinyin: "Ã¨r", audio: ""},
            {chinese: "ä¸‰", pinyin: "sÄn", audio: ""},
            {chinese: "å››", pinyin: "sÃ¬", audio: ""},
            {chinese: "äº”", pinyin: "wÇ”", audio: ""},
            {chinese: "å…­", pinyin: "liÃ¹", audio: ""},
            {chinese: "ä¸ƒ", pinyin: "qÄ«", audio: ""},
            {chinese: "å…«", pinyin: "bÄ", audio: ""},
            {chinese: "ä¹", pinyin: "jiÇ”", audio: ""},
            {chinese: "å", pinyin: "shÃ­", audio: ""},
            {chinese: "ä½ å¥½", pinyin: "nÇ hÇo", audio: ""},
            {chinese: "è°¢è°¢", pinyin: "xiÃ¨ xie", audio: ""},
            {chinese: "ä¸å®¢æ°”", pinyin: "bÃº kÃ¨ qi", audio: ""},
            {chinese: "å¯¹ä¸èµ·", pinyin: "duÃ¬ bu qÇ", audio: ""},
            {chinese: "æ²¡å…³ç³»", pinyin: "mÃ©i guÄn xi", audio: ""},
            {chinese: "å†è§", pinyin: "zÃ i jiÃ n", audio: ""},
            {chinese: "æ˜¯", pinyin: "shÃ¬", audio: ""},
            {chinese: "ä¸æ˜¯", pinyin: "bÃº shÃ¬", audio: ""},
            {chinese: "å¥½", pinyin: "hÇo", audio: ""},
            {chinese: "ä¸å¥½", pinyin: "bÃ¹ hÇo", audio: ""},
            {chinese: "ä»Šå¤©", pinyin: "jÄ«n tiÄn", audio: ""},
            {chinese: "æ˜å¤©", pinyin: "mÃ­ng tiÄn", audio: ""},
            {chinese: "æ˜¨å¤©", pinyin: "zuÃ³ tiÄn", audio: ""},
            {chinese: "ç°åœ¨", pinyin: "xiÃ n zÃ i", audio: ""},
            {chinese: "å­¦æ ¡", pinyin: "xuÃ© xiÃ o", audio: ""},
            {chinese: "å®¶", pinyin: "jiÄ", audio: ""},
            {chinese: "ä¸­å›½", pinyin: "zhÅng guÃ³", audio: ""},
            {chinese: "åŒ—äº¬", pinyin: "bÄ›i jÄ«ng", audio: ""},
            {chinese: "æ°´", pinyin: "shuÇ", audio: ""},
            {chinese: "èŒ¶", pinyin: "chÃ¡", audio: ""},
            {chinese: "ç±³é¥­", pinyin: "mÇ fÃ n", audio: ""},
            {chinese: "æ°´æœ", pinyin: "shuÇ guÇ’", audio: ""},
            {chinese: "è‹¹æœ", pinyin: "pÃ­ng guÇ’", audio: ""},
            {chinese: "çº¢", pinyin: "hÃ³ng", audio: ""},
            {chinese: "ç™½", pinyin: "bÃ¡i", audio: ""},
            {chinese: "é»‘", pinyin: "hÄ“i", audio: ""},
            {chinese: "å¤§", pinyin: "dÃ ", audio: ""},
            {chinese: "å°", pinyin: "xiÇo", audio: ""},
            {chinese: "çŒ«", pinyin: "mÄo", audio: ""},
            {chinese: "ç‹—", pinyin: "gÇ’u", audio: ""},
            {chinese: "ä¹¦", pinyin: "shÅ«", audio: ""},
            {chinese: "ç¬”", pinyin: "bÇ", audio: ""},
            {chinese: "åƒ", pinyin: "chÄ«", audio: ""},
            {chinese: "å–", pinyin: "hÄ“", audio: ""},
            {chinese: "çœ‹", pinyin: "kÃ n", audio: ""},
            {chinese: "å¬", pinyin: "tÄ«ng", audio: ""},
            {chinese: "è¯´", pinyin: "shuÅ", audio: ""},
            {chinese: "å»", pinyin: "qÃ¹", audio: ""},
            {chinese: "æ¥", pinyin: "lÃ¡i", audio: ""},
            {chinese: "å­¦ä¹ ", pinyin: "xuÃ© xÃ­", audio: ""},
            {chinese: "å·¥ä½œ", pinyin: "gÅng zuÃ²", audio: ""}
        ];

        // æ¸¸æˆçŠ¶æ€å˜é‡
        let currentRound = 0;
        let score = 0;
        let timer = null;
        let timeLeft = TIME_PER_ROUND;
        let currentWord = null;
        let correctPinyin = "";
        let gameActive = false;
        let gamePaused = false;
        let voices = [];
        let selectedVoice = null;
        let speechRate = 1;
        let speechVolume = 1;
        let gameResults = [];
        let wrongWords = [];
        let clickOccurred = false;
        let usedWords = [];

        // DOMå…ƒç´ å¼•ç”¨
        const welcomePage = document.getElementById('welcome-page');
        const gamePage = document.getElementById('game-page');
        const startGameBtn = document.getElementById('start-game-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const playBtn = document.getElementById('play-btn');
        const restartGameBtn = document.getElementById('restart-game-btn');
        const restartBtn = document.getElementById('restart-btn');
        const backToWelcomeBtn = document.getElementById('back-to-welcome');
        const roundDisplay = document.getElementById('round-display');
        const scoreDisplay = document.getElementById('score-display');
        const timerDisplay = document.getElementById('timer-display');
        const timeProgress = document.getElementById('time-progress');
        const bubbleContainer = document.getElementById('bubble-container');
        const welcomeVoiceSelect = document.getElementById('welcome-voice-select');
        const welcomeRateControl = document.getElementById('welcome-rate-control');
        const welcomeVolumeControl = document.getElementById('welcome-volume-control');
        const welcomeRateValue = document.getElementById('welcome-rate-value');
        const welcomeVolumeValue = document.getElementById('welcome-volume-value');
        const gameOverModal = document.getElementById('game-over-modal');
        const finalScore = document.getElementById('final-score');
        const resultsList = document.getElementById('results-list');
        const demoWords = document.querySelectorAll('.demo-word');

        // åˆå§‹åŒ–å‡½æ•°
        function init() {
            startGameBtn.addEventListener('click', startGame);
            pauseBtn.addEventListener('click', togglePause);
            playBtn.addEventListener('click', playCurrentWord);
            restartGameBtn.addEventListener('click', restartGame);
            restartBtn.addEventListener('click', restartGame);
            backToWelcomeBtn.addEventListener('click', backToWelcome);
            
            welcomeRateControl.addEventListener('input', () => {
                speechRate = parseFloat(welcomeRateControl.value);
                welcomeRateValue.textContent = speechRate.toFixed(1);
            });
            
            welcomeVolumeControl.addEventListener('input', () => {
                speechVolume = parseFloat(welcomeVolumeControl.value);
                welcomeVolumeValue.textContent = speechVolume.toFixed(1);
            });
            
            demoWords.forEach(word => {
                word.addEventListener('click', function() {
                    const wordText = this.getAttribute('data-word');
                    playText(wordText);
                });
            });
            
            loadVoices();
            speechSynthesis.onvoiceschanged = loadVoices;
        }

        // è¯­éŸ³å¤„ç†å‡½æ•°
        function loadVoices() {
            voices = speechSynthesis.getVoices();
            welcomeVoiceSelect.innerHTML = '';
            
            const chineseVoices = voices.filter(voice => 
                voice.lang.startsWith('zh') || voice.lang.includes('Chinese')
            );
            
            if (chineseVoices.length > 0) {
                chineseVoices.forEach(voice => {
                    const option = document.createElement('option');
                    option.value = voice.voiceURI;
                    option.textContent = `${voice.name} (${voice.lang})`;
                    welcomeVoiceSelect.appendChild(option);
                });
                
                selectedVoice = chineseVoices[0];
                welcomeVoiceSelect.value = selectedVoice.voiceURI;
            } else {
                const option = document.createElement('option');
                option.textContent = 'æœªæ‰¾åˆ°ä¸­æ–‡è¯­éŸ³ï¼Œä½¿ç”¨é»˜è®¤è¯­éŸ³';
                welcomeVoiceSelect.appendChild(option);
                selectedVoice = voices[0] || null;
            }
            
            welcomeVoiceSelect.addEventListener('change', () => {
                const selected = welcomeVoiceSelect.value;
                selectedVoice = voices.find(voice => voice.voiceURI === selected) || null;
            });
        }

        function playText(text) {
            speechSynthesis.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            
            if (selectedVoice) {
                utterance.voice = selectedVoice;
            }
            
            utterance.rate = speechRate;
            utterance.volume = speechVolume;
            utterance.lang = 'zh-CN';
            
            speechSynthesis.speak(utterance);
        }

        // æ‹¼éŸ³å¤„ç†å‡½æ•°
        function getSyllableCount(pinyin) {
            return pinyin.split(/[\s-]+/).filter(s => s.length > 0).length;
        }

        function isValidPinyin(pinyin) {
            const pinyinRegex = /^([bpmfdtnlgkhjqxzcsrzhchshyw]|[bpmfdtnlgkhjqxzcsr]h)?[aÄÃ¡ÇÃ eÄ“Ã©Ä›Ã¨iÄ«Ã­ÇÃ¬oÅÃ³Ç’Ã²uÅ«ÃºÇ”Ã¹Ã¼Ç–Ç˜ÇšÇœv]((ng|n)?[aÄÃ¡ÇÃ eÄ“Ã©Ä›Ã¨iÄ«Ã­ÇÃ¬oÅÃ³Ç’Ã²uÅ«ÃºÇ”Ã¹Ã¼Ç–Ç˜ÇšÇœv]?r?)(?:\s+([bpmfdtnlgkhjqxzcsrzhchshyw]|[bpmfdtnlgkhjqxzcsr]h)?[aÄÃ¡ÇÃ eÄ“Ã©Ä›Ã¨iÄ«Ã­ÇÃ¬oÅÃ³Ç’Ã²uÅ«ÃºÇ”Ã¹Ã¼Ç–Ç˜ÇšÇœv]((ng|n)?[aÄÃ¡ÇÃ eÄ“Ã©Ä›Ã¨iÄ«Ã­ÇÃ¬oÅÃ³Ç’Ã²uÅ«ÃºÇ”Ã¹Ã¼Ç–Ç˜ÇšÇœv]?r?))*$/i;
            return pinyinRegex.test(pinyin);
        }

        // ç”Ÿæˆç›¸ä¼¼æ‹¼éŸ³å¹²æ‰°é¡¹
        function generateSimilarPinyin(pinyin) {
            const syllableCount = getSyllableCount(pinyin);
            const syllables = pinyin.split(/\s+/);
            const similarPinyins = [];
            
            if (syllableCount === 1) {
                const base = syllables[0];
                
                const initials = {
                    'l': ['n', 'r'], 'n': ['l', 'r'], 'r': ['l', 'n'],
                    'z': ['c', 's'], 'c': ['z', 's'], 's': ['z', 'c'],
                    'zh': ['ch', 'sh'], 'ch': ['zh', 'sh'], 'sh': ['zh', 'ch'],
                    'b': ['p'], 'p': ['b'], 'd': ['t'], 't': ['d'],
                    'g': ['k'], 'k': ['g'], 'j': ['q', 'x'], 'q': ['j', 'x'], 'x': ['j', 'q']
                };
                
                const finals = {
                    'a': ['o', 'e'], 'o': ['a', 'e'], 'e': ['a', 'o'],
                    'i': ['u', 'Ã¼'], 'u': ['i', 'Ã¼'], 'Ã¼': ['i', 'u'],
                    'ai': ['ei'], 'ei': ['ai'], 'ao': ['ou'], 'ou': ['ao'],
                    'an': ['ang'], 'ang': ['an'], 'en': ['eng'], 'eng': ['en'],
                    'in': ['ing'], 'ing': ['in']
                };
                
                const tones = {
                    'Ä': ['Ã¡', 'Ç', 'Ã '], 'Ã¡': ['Ä', 'Ç', 'Ã '], 'Ç': ['Ä', 'Ã¡', 'Ã '], 'Ã ': ['Ä', 'Ã¡', 'Ç'],
                    'Ä“': ['Ã©', 'Ä›', 'Ã¨'], 'Ã©': ['Ä“', 'Ä›', 'Ã¨'], 'Ä›': ['Ä“', 'Ã©', 'Ã¨'], 'Ã¨': ['Ä“', 'Ã©', 'Ä›'],
                    'Ä«': ['Ã­', 'Ç', 'Ã¬'], 'Ã­': ['Ä«', 'Ç', 'Ã¬'], 'Ç': ['Ä«', 'Ã­', 'Ã¬'], 'Ã¬': ['Ä«', 'Ã­', 'Ç'],
                    'Å': ['Ã³', 'Ç’', 'Ã²'], 'Ã³': ['Å', 'Ç’', 'Ã²'], 'Ç’': ['Å', 'Ã³', 'Ã²'], 'Ã²': ['Å', 'Ã³', 'Ç’'],
                    'Å«': ['Ãº', 'Ç”', 'Ã¹'], 'Ãº': ['Å«', 'Ç”', 'Ã¹'], 'Ç”': ['Å«', 'Ãº', 'Ã¹'], 'Ã¹': ['Å«', 'Ãº', 'Ç”'],
                    'Ç–': ['Ç˜', 'Çš', 'Çœ'], 'Ç˜': ['Ç–', 'Çš', 'Çœ'], 'Çš': ['Ç–', 'Ç˜', 'Çœ'], 'Çœ': ['Ç–', 'Ç˜', 'Çš']
                };
                
                for (let i = 0; i < base.length; i++) {
                    const char = base[i];
                    
                    if (i === 0 && initials[char]) {
                        for (const replacement of initials[char]) {
                            const newPinyin = replacement + base.substring(1);
                            if (isValidPinyin(newPinyin) && newPinyin !== base && !similarPinyins.includes(newPinyin)) {
                                similarPinyins.push(newPinyin);
                            }
                        }
                    }
                    
                    if (i > 0 && finals[char]) {
                        for (const replacement of finals[char]) {
                            const newPinyin = base.substring(0, i) + replacement + base.substring(i+1);
                            if (isValidPinyin(newPinyin) && newPinyin !== base && !similarPinyins.includes(newPinyin)) {
                                similarPinyins.push(newPinyin);
                            }
                        }
                    }
                    
                    if (tones[char]) {
                        for (const replacement of tones[char]) {
                            const newPinyin = base.substring(0, i) + replacement + base.substring(i+1);
                            if (isValidPinyin(newPinyin) && newPinyin !== base && !similarPinyins.includes(newPinyin)) {
                                similarPinyins.push(newPinyin);
                            }
                        }
                    }
                }
            } else if (syllableCount === 2) {
                const [first, second] = syllables;
                
                const firstVariations = generateSimilarPinyin(first);
                for (const variation of firstVariations) {
                    const newPinyin = `${variation} ${second}`;
                    if (isValidPinyin(newPinyin) && !similarPinyins.includes(newPinyin)) {
                        similarPinyins.push(newPinyin);
                    }
                }
                
                const secondVariations = generateSimilarPinyin(second);
                for (const variation of secondVariations) {
                    const newPinyin = `${first} ${variation}`;
                    if (isValidPinyin(newPinyin) && !similarPinyins.includes(newPinyin)) {
                        similarPinyins.push(newPinyin);
                    }
                }
            }
            
            return similarPinyins.slice(0, 5);
        }

        function generateDistractors(correctPinyin, count) {
            const similarPinyins = generateSimilarPinyin(correctPinyin);
            const distractors = [];
            
            for (let i = 0; i < Math.min(count-1, similarPinyins.length); i++) {
                distractors.push(similarPinyins[i]);
            }
            
            if (distractors.length < count - 1) {
                const syllableCount = getSyllableCount(correctPinyin);
                
                const singleSyllables = ["mÄ", "mÃ¡", "mÇ", "mÃ ", "bÄ", "bÃ¡", "bÇ", "bÃ ", 
                                        "dÄ", "dÃ¡", "dÇ", "dÃ ", "fÄ", "fÃ¡", "fÇ", "fÃ ",
                                        "gÄ“", "gÃ©", "gÄ›", "gÃ¨", "kÄ“", "kÃ©", "kÄ›", "kÃ¨",
                                        "hÄ“", "hÃ©", "hÄ›", "hÃ¨", "jÄ«", "jÃ­", "jÇ", "jÃ¬",
                                        "qÄ«", "qÃ­", "qÇ", "qÃ¬", "xÄ«", "xÃ­", "xÇ", "xÃ¬",
                                        "zhÄ«", "zhÃ­", "zhÇ", "zhÃ¬", "chÄ«", "chÃ­", "chÇ", "chÃ¬",
                                        "shÄ«", "shÃ­", "shÇ", "shÃ¬", "rÄ«", "rÃ­", "rÇ", "rÃ¬",
                                        "zÄ«", "zÃ­", "zÇ", "zÃ¬", "cÄ«", "cÃ­", "cÇ", "cÃ¬",
                                        "sÄ«", "sÃ­", "sÇ", "sÃ¬", "yÄ«", "yÃ­", "yÇ", "yÃ¬",
                                        "wÅ«", "wÃº", "wÇ”", "wÃ¹"];
                
                const doubleSyllables = ["mÄ ma", "bÃ  ba", "gÄ“ ge", "dÃ¬ di", "jiÄ› jie", "mÃ¨i mei",
                                        "nÇi nai", "yÃ© ye", "lÇo shÄ«", "xuÃ© sheng", "tÃ³ng xuÃ©",
                                        "pÃ©ng you", "shÅ« shu", "Ä yÃ­", "xuÃ© xiÃ o", "jiÄo shÃ¬", 
                                        "kÃ¨ bÄ›n", "qiÄn bÇ", "xiÃ ng pÃ­", "zhuÅ zi", "yÇ zi"];
                
                let sourceArray = syllableCount === 1 ? singleSyllables : doubleSyllables;
                
                const filteredSource = sourceArray.filter(p => 
                    p !== correctPinyin && !distractors.includes(p) && !similarPinyins.includes(p) && isValidPinyin(p)
                );
                
                while (distractors.length < count - 1 && filteredSource.length > 0) {
                    const randomIndex = Math.floor(Math.random() * filteredSource.length);
                    const distractor = filteredSource.splice(randomIndex, 1)[0];
                    if (!distractors.includes(distractor)) {
                        distractors.push(distractor);
                    }
                }
            }
            
            while (distractors.length < count - 1) {
                distractors.push(distractors[0]);
            }
            
            return distractors;
        }

        // æ³¡æ³¡ç›¸å…³å‡½æ•°
        function createBubble(pinyin, isCorrect, index, total) {
            const bubble = document.createElement('div');
            bubble.className = 'bubble normal';
            bubble.textContent = pinyin;
            bubble.dataset.correct = isCorrect;
            
            const containerWidth = bubbleContainer.offsetWidth;
            const containerHeight = bubbleContainer.offsetHeight;
            const bubbleSize = 130;
            
            const sectorWidth = containerWidth / total;
            const left = (sectorWidth * index) + (sectorWidth - bubbleSize) / 2;
            const top = Math.random() * (containerHeight - bubbleSize - 150) + 100;
            
            bubble.style.left = `${left}px`;
            bubble.style.top = `${top}px`;
            
            const duration = Math.random() * (BUBBLE_MAX_DURATION - BUBBLE_MIN_DURATION) + BUBBLE_MIN_DURATION;
            
            const maxXMovement = containerWidth * 0.15;
            const maxYMovement = containerHeight * 0.15;
            
            const xMovement = (Math.random() - 0.5) * maxXMovement;
            const yMovement = (Math.random() - 0.5) * maxYMovement;
            
            bubble.style.setProperty('--x-movement', `${xMovement}px`);
            bubble.style.setProperty('--y-movement', `${yMovement}px`);
            bubble.style.setProperty('--y-movement-quarter', `${yMovement * 0.25}px`);
            bubble.style.setProperty('--y-movement-half', `${yMovement * 0.5}px`);
            bubble.style.setProperty('--y-movement-three-quarters', `${yMovement * 0.75}px`);
            
            bubble.style.animation = `float ${duration}s linear infinite`;
            
            bubble.addEventListener('click', () => handleBubbleClick(bubble, isCorrect));
            
            return bubble;
        }

        function clearBubbles() {
            bubbleContainer.innerHTML = '';
            clickOccurred = false;
        }

        function createBubbles() {
            clearBubbles();
            
            const bubbleCount = Math.floor(Math.random() * (MAX_BUBBLE_COUNT - MIN_BUBBLE_COUNT + 1)) + MIN_BUBBLE_COUNT;
            
            const pinyinOptions = [correctPinyin, ...generateDistractors(correctPinyin, bubbleCount)];
            
            for (let i = pinyinOptions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [pinyinOptions[i], pinyinOptions[j]] = [pinyinOptions[j], pinyinOptions[i]];
            }
            
            pinyinOptions.forEach((pinyin, index) => {
                const isCorrect = pinyin === correctPinyin;
                const bubble = createBubble(pinyin, isCorrect, index, pinyinOptions.length);
                bubbleContainer.appendChild(bubble);
            });
        }

        function handleBubbleClick(bubble, isCorrect) {
            if (!gameActive || clickOccurred || gamePaused) return;
            
            clickOccurred = true;
            
            clearInterval(timer);
            
            const result = {
                round: currentRound,
                word: currentWord.chinese,
                pinyin: currentWord.pinyin,
                correctPinyin: correctPinyin,
                selectedPinyin: bubble.textContent,
                isCorrect: isCorrect,
                timeUsed: TIME_PER_ROUND - timeLeft
            };
            
            gameResults.push(result);
            
            const allBubbles = document.querySelectorAll('.bubble');
            allBubbles.forEach(b => {
                if (b.dataset.correct === 'true') {
                    b.classList.remove('normal');
                    b.classList.add('correct');
                } else {
                    b.classList.remove('normal');
                    b.classList.add('incorrect');
                }
            });
            
            if (isCorrect) {
                score += POINTS_PER_CORRECT;
                playCorrectSound();
                
                scoreDisplay.textContent = score;
                
                setTimeout(nextRound, 1000);
            } else {
                playIncorrectSound();
                wrongWords.push(currentWord);
                
                setTimeout(nextRound, 1000);
            }
        }

        // éŸ³æ•ˆå‡½æ•°
        function playCorrectSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 523.25;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log("éŸ³æ•ˆæ’­æ”¾å¤±è´¥:", e);
            }
        }

        function playIncorrectSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 220;
                oscillator.type = 'sawtooth';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log("éŸ³æ•ˆæ’­æ”¾å¤±è´¥:", e);
            }
        }

        // æ¸¸æˆæµç¨‹æ§åˆ¶å‡½æ•°
        function startGame() {
            welcomePage.style.display = 'none';
            gamePage.style.display = 'block';
            
            gameActive = true;
            gamePaused = false;
            currentRound = 0;
            score = 0;
            gameResults = [];
            wrongWords = [];
            usedWords = [];
            
            pauseBtn.textContent = "æš‚åœæ¸¸æˆ â¸ï¸";
            
            scoreDisplay.textContent = score;
            
            nextRound();
        }

        function togglePause() {
            if (!gameActive) return;
            
            gamePaused = !gamePaused;
            
            if (gamePaused) {
                clearInterval(timer);
                pauseBtn.textContent = "ç»§ç»­æ¸¸æˆ â–¶ï¸";
                speechSynthesis.cancel();
                
                const bubbles = document.querySelectorAll('.bubble');
                bubbles.forEach(bubble => {
                    bubble.classList.add('hidden');
                });
                
                const overlay = document.createElement('div');
                overlay.className = 'pause-overlay';
                overlay.textContent = 'æ¸¸æˆæš‚åœ â¸ï¸';
                bubbleContainer.appendChild(overlay);
            } else {
                startTimer();
                pauseBtn.textContent = "æš‚åœæ¸¸æˆ â¸ï¸";
                
                const bubbles = document.querySelectorAll('.bubble');
                bubbles.forEach(bubble => {
                    bubble.classList.remove('hidden');
                });
                
                const overlay = bubbleContainer.querySelector('.pause-overlay');
                if (overlay) {
                    bubbleContainer.removeChild(overlay);
                }
            }
        }

        function nextRound() {
            currentRound++;
            
            if (currentRound > TOTAL_ROUNDS) {
                endGame();
                return;
            }
            
            roundDisplay.textContent = `${currentRound}/${TOTAL_ROUNDS}`;
            timeLeft = TIME_PER_ROUND;
            timerDisplay.textContent = `${timeLeft}ç§’`;
            timeProgress.style.width = '100%';
            
            const availableWords = wordLibrary.filter(word => !usedWords.includes(word.chinese));
            if (availableWords.length === 0) {
                usedWords = [];
            }
            
            const randomIndex = Math.floor(Math.random() * availableWords.length);
            currentWord = availableWords[randomIndex];
            usedWords.push(currentWord.chinese);
            correctPinyin = currentWord.pinyin;
            
            createBubbles();
            
            playCurrentWord();
            setTimeout(playCurrentWord, 1500);
            
            startTimer();
        }

        function playCurrentWord() {
            if (currentWord && gameActive && !gamePaused) {
                if (currentWord.audio) {
                    playText(currentWord.chinese);
                } else {
                    const syllableCount = getSyllableCount(correctPinyin);
                    let textToPlay = currentWord.chinese;
                    
                    if (syllableCount === 1) {
                        textToPlay = textToPlay.charAt(0);
                    }
                    
                    playText(textToPlay);
                }
            }
        }

        function startTimer() {
            clearInterval(timer);
            
            timer = setInterval(() => {
                if (!gamePaused) {
                    timeLeft--;
                    timerDisplay.textContent = `${timeLeft}ç§’`;
                    timeProgress.style.width = `${(timeLeft / TIME_PER_ROUND) * 100}%`;
                    
                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        
                        const result = {
                            round: currentRound,
                            word: currentWord.chinese,
                            pinyin: currentWord.pinyin,
                            correctPinyin: correctPinyin,
                            selectedPinyin: "è¶…æ—¶",
                            isCorrect: false,
                            timeUsed: TIME_PER_ROUND
                        };
                        
                        gameResults.push(result);
                        wrongWords.push(currentWord);
                        
                        setTimeout(nextRound, 1000);
                    }
                }
            }, 1000);
        }

        function endGame() {
            gameActive = false;
            gamePaused = false;
            clearInterval(timer);
            
            finalScore.textContent = score;
            displayResults();
            gameOverModal.style.display = 'flex';
        }

        function displayResults() {
            resultsList.innerHTML = '';
            
            gameResults.forEach(result => {
                const resultItem = document.createElement('div');
                resultItem.className = `result-item ${result.isCorrect ? 'correct' : 'incorrect'}`;
                
                resultItem.innerHTML = `
                    <div>
                        <strong>ç¬¬${result.round}è½®:</strong> ${result.word} 
                        <span class="correct-answer">æ­£ç¡®ç­”æ¡ˆ: ${result.correctPinyin}</span>
                    </div>
                    <div>
                        é€‰æ‹©: ${result.selectedPinyin} | 
                        ${result.isCorrect ? 'æ­£ç¡®' : 'é”™è¯¯'} | 
                        ç”¨æ—¶: ${result.timeUsed}ç§’
                    </div>
                `;
                
                resultsList.appendChild(resultItem);
            });
        }

        function restartGame() {
            gameOverModal.style.display = 'none';
            startGame();
        }

        function backToWelcome() {
            gameOverModal.style.display = 'none';
            gamePage.style.display = 'none';
            welcomePage.style.display = 'block';
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>